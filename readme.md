<p align="center">
  <img src="docs/images/cover.gif" alt="Logo"/>
</p>

# CrossWindow

[![cmake-img]][cmake-url]
[![License][license-img]][license-url]
[![Travis Tests][travis-img]][travis-url]
[![Appveyor Tests][appveyor-img]][appveyor-url]
[![CircleCI Tests][circleci-img]][circleci-url]
[![Coverage Tests][codecov-img]][codecov-url]

A basic cross platform system abstraction library for managing windows and performing OS tasks. 

## Features

- üåü Simple Window Creation

- ‚å®Ô∏è üñ±Ô∏è üëÜ üéÆ Basic Input (Keyboard, Mouse, Touch, and Gamepad)

- üëª Platform specific features (Mac Transparency, Touch Bar, Mobile Accelerometer, etc.)

- üíä Unit Tests + Test Coverage ([Appveyor][appveyor-url] for **Windows**, [CircleCI][circleci-url] for **Android / MacOS / iOS**, [Travis][travis-url] for **Linux/Noop**)

### Supported Platforms

- üñºÔ∏è Windows (Win32)

- üçé Mac (Cocoa)

- üì± iOS (AppKit)

- üêß Linux (XCB)

- ü§ñ Android

- üåê WebAssembly

- ‚ùå Noop (Headless)


## Installation

First add the repo as a submodule in your dependencies folder such as `external/`:

```bash
cd external
git submodule add https://github.com/alaingalvan/CrossWindow.git
```

Then in your `CMakeLists.txt` file, include the following:

```cmake
# ‚¨á Add your dependency:
add_subdirectories(external/CrossWindow)

# ‚ùé When creating your executable use CrossWindow's abstraction function:
xwin_add_executable(
    # Target
    ${PROJECT_NAME}
    # Source Files (make sure to surround in quotations so CMake treats it as a list)
    "${SOURCE_FILES}"
)

# üîó Link CrossWindow to your project:
target_link_libraries(
    ${PROJECT_NAME}
    CrossWindow
)
```

Fill out the rest of your `CMakeLists.txt` file with any other source files and dependencies you may have, then in your project root:

```bash

# üñºÔ∏è To build your Visual Studio solution on Windows x64
mkdir visualstudio
cd visualstudio
cmake .. -A x64

# üçé To build your XCode project On Mac OS for Mac OS / iOS
mkdir xcode
cd xcode
cmake .. -G Xcode

# üêß To build your .make file on Linux
mkdir make
cd make
cmake ..
cmake --build .

# CrossWindow comes with a make function to generate Ubuntu `.deb` files:
make ubuntu
```

For WebAssembly you'll need to have [Emscripten](http://kripken.github.io/emscripten-site/docs/getting_started/downloads.html) installed. Assuming you have the SDK installed, do the following to build a WebAssembly project:

```bash
# üåê For WebAssembly Projects
mkdir wasm
cd wasm
cmake .. -DXWIN_OS=WASM -DCMAKE_TOOLCHAIN_FILE="$EMSDK/emscripten/1.38.1/cmake/Modules/Platform/Emscripten.cmake" -DCMAKE_BUILD_TYPE=Release

# Run emconfigure with the normal configure command as an argument.
$EMSDK/emscripten/emconfigure ./configure

# Run emmake with the normal make to generate linked LLVM bitcode.
$EMSDK/emscripten/emmake make

# Compile the linked bitcode generated by make (project.bc) to JavaScript.
#  'project.bc' should be replaced with the make output for your project (e.g. 'yourproject.so')
$EMSDK/emscripten/emcc project.bc -o project.js
```

For more information visit the [Emscripten Docs on CMake](https://kripken.github.io/emscripten-site/docs/compiling/Building-Projects.html#using-libraries).

For **Android Studio** you'll need to make a project, then edit your `build.gradle` file.

```groovy
// ü§ñ To build your Android Studio project
android {
    ...
    externalNativeBuild {
        cmake {
            ...
            // Use the following syntax when passing arguments to variables:
            // arguments "-DVAR_NAME=ARGUMENT".
            arguments "-DXWIN_OS=ANDROID",
            // The following line passes 'rtti' and 'exceptions' to 'ANDROID_CPP_FEATURES'.
            "-DANDROID_CPP_FEATURES=rtti exceptions"
        }
    }
  buildTypes {...}

  // Use this block to link Gradle to your CMake build script.
  externalNativeBuild {
    cmake {...}
  }
}
```

for more information visit [Android Studio's docs on CMake](https://developer.android.com/ndk/guides/cmake).

## Usage

Then create a main delegate function `void xmain(int argc, const char** argv)` in a `.cpp` file in your project (for example "`XMain.cpp`") where you'll put your application logic:

```cpp
#include "CrossWindow/CrossWindow.h"

void xmain(int argc, const char** argv)
{
    // üñºÔ∏è Create Window Description
    xwin::WindowDesc windowDesc;
    windowDesc.name = "Test";
    windowDesc.title = "My Title";
    windowDesc.visible = true;
    windowDesc.width = 1280;
    windowDesc.height = 720;

    bool closed = false;
    
    // üåü Initialize
    xwin::Window window;
    xwin::EventQueue eventQueue;

    if (!window.create(windowDesc, eventQueue))
    { return; }

    // üèÅ Engine loop
    bool isRunning = true;

    while (isRunning)
    {
        // ‚ôªÔ∏è Update the event queue
        eventQueue.update();

        // üéà Iterate through that queue:
        while (!eventQueue.empty())
        {
            const xwin::Event& event = eventQueue.front();
            
            switch(event.type)
            {
            case xwin::EventType::MouseMove:
            xwin::MouseData* mouse = static_cast<xwin::MouseData*>(e.data);
            //mouse.x, mouse.y
            break;
            case xwin::EventType::Close:
            window.close();
            break;
            default:
            // Do nothing
            }

            eventQueue.pop();
        }
    }
}
```

This `xmain` function will be called from a *platform specific main function* that will be included in your main project by CMake. If you ever need to access something from the platform specific main function for whatever reason, you'll find it in `xwin::getXWinState()`.

For more examples visit the [Documentation](/docs) or try out the [demos](https://github.com/alaingalvan/CrossWindow-Demos).

## Development

Be sure to have [CMake](https://cmake.org) Installed.

| CMake Options | Description |
|:-------------:|:-----------:|
| `XWIN_TESTS` | Whether or not unit tests are enabled. Defaults to `OFF`, Can be `ON` or `OFF`. |
| `XWIN_OS` | What Operating System to build for, defaults to `AUTO`, can be `NOOP`, `WINDOWS`, `MACOS`, `LINUX`, `ANDROID`, `IOS`, `WASM`. |

We would recommend making a folder where solution files will be built to to avoid making your file system look too messy, such as `visualstudio/` or `xcode/` depending on the platform you're building for:

```bash
# üëØ Clone the repo
git clone https://github.com/alaingalvan/crosswindow.git --recurse-submodules
cd crosswindow

# üñºÔ∏è To build your Visual Studio solution on Windows x64
mkdir visualstudio
cd visualstudio
cmake .. -DXWIN_TESTS=ON -A x64

# üçé To build your XCode project On Mac OS for Mac OS / iOS
mkdir xcode
cd xcode
cmake .. -DXWIN_TESTS=ON -G Xcode

# üêß To build your makefile on Linux
mkdir make
cd make
cmake .. -DXWIN_TESTS=ON
```

Whenever you add new files to the project, run `cmake ..` from your solution/project folder, and if you edit the `CMakeLists.txt` file be sure to delete the generated files and run Cmake again.

## Future Goals

- [ ] ‚ùé Xbox One support with Universal Windows Platform (WMP).

- [ ] üÖøÔ∏è Playstation 4 support

- [ ] üíû Nintendo Switch support

- [ ] üì¶ **Create-CrossWindow-App CLI Tool** similar to [Create-React-App](https://github.com/facebook/create-react-app) to auto-generate all platform specific projects and set up your seed with 0 configuration. `create-xwin-app MyGame`.

- [ ] üöú Wayland / XLib support for Linux

> **Note:** Playstation 4 and Nintendo Switch will require that you email/direct message me to verify your licensing prior to releasing the CrossWindow source for those platforms.

## License

CrossWindow is licensed as either **MIT** or **Apache-2.0**, whichever you would prefer.

[cmake-img]: https://img.shields.io/badge/cmake-3.6-1f9948.svg?style=flat-square
[cmake-url]: https://cmake.org/
[license-img]: https://img.shields.io/:license-mit-blue.svg?style=flat-square
[license-url]: https://opensource.org/licenses/MIT
[travis-img]: https://img.shields.io/travis/alaingalvan/CrossWindow.svg?style=flat-square&logo=travis
[travis-url]: https://travis-ci.org/alaingalvan/CrossWindow
[appveyor-img]: https://img.shields.io/appveyor/ci/alaingalvan/CrossWindow.svg?style=flat-square&logo=windows
[appveyor-url]: https://ci.appveyor.com/project/alaingalvan/crosswindow
[circleci-img]: https://img.shields.io/circleci/project/github/alaingalvan/CrossWindow.svg?style=flat-square&logo=appveyor
[circleci-url]: https://circleci.com/gh/alaingalvan/CrossWindow
[codecov-img]: https://img.shields.io/codecov/c/github/alaingalvan/CrossWindow.svg?style=flat-square
[codecov-url]: https://codecov.io/gh/alaingalvan/CrossWindow
